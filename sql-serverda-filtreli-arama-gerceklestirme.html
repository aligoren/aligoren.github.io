<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content=".NET, SQL, Python, Açık Kaynak">

    <title>SQL Server'da Filtreli Arama Gerceklestirme - Ali GÖREN...</title>

    <link rel="canonical" href="https://aligoren.comhttps://aligoren.com/sql-serverda-filtreli-arama-gerceklestirme">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="https://aligoren.com/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="https://aligoren.com/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <!-- <link rel="stylesheet" href="https://aligoren.com/css/syntax.css"> -->
    <link rel="stylesheet" href="https://aligoren.com/css/prism.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <link type="application/atom+xml" rel="alternate" href="https://aligoren.com/feed.xml" title="Ali GÖREN..." />

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://aligoren.com/">Ali GÖREN...</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="https://aligoren.com/">Anasayfa</a>
                </li>
                
				
                
				
                <li>
                    <a href="https://aligoren.com/hakkimda">Hakkımda</a>
                </li>
				
                
				
                <li>
                    <a href="https://aligoren.com/kategoriler">Kategoriler</a>
                </li>
				
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header" style="background-image: url('https://aligoren.com/img/home-bg.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1 class="yazibasligi">SQL Server'da Filtreli Arama Gerceklestirme</h1>
                    
                    <!--<span class="meta">Posted by Ali GÖREN... on August 3, 2016</span>-->
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 yaziici">

				<p>Merhaba. Karmaşık bir arama işleminiz olabilir. Örneğin basit bir uygulama ile olaya bakalım:</p>

<p>Varsayalım ki InsanKaynaklari adında bir tablonuz bulunmakta. Bu tablo üzerinde bazı aramalar gerçekleştirmek istiyorsunuz. Örneğin bu aramalar</p>

<p>Doğum Tarihi, Doğum Yeri, Cinsiyet, Medeni Durum, Maaş, Eğitim Düzeyi, Mesleki Belge ya da Meslek şeklinde olabilir. Normalde bir aramada tek şekilde şöyle bakabilirdik</p>

<pre><code class="language-sql">SELECT * FROM InsanKaynaklari as Ik
WHERE Ik.MedeniDurum='Bekar' AND Ik.Cinsiyet='Erkek'
</code></pre>

<p>Bu sorgu ilk başlangıç olarak işimizi görüyor olabilir. Ancak bazı durumlarda sorgularımız sadece iki tane ile sınırlı kalmayabilir ve işin ilginç noktası bu sorguları örneğin C# tarafında gerçekleştiriyor olabiliriz. 6-7 adet textBox içinden sadece 3 tanesinin dolu olduğunu, diğerlerinin NULL gönderildiğini düşünün.</p>

<p>Bu gibi durumlar için bir Stored Procedure oluşturabiliriz. Bir Stored Procedure oluşturma aşamasını bildiğimizi varsayarak basit olarak bir SP oluşturalım. Örneğin:</p>

<pre><code class="language-sql">CREATE PROCEDURE PersonelAra
	@dtarih date,
	@dyeri nvarchar(50),
	@cinsiyet nvarchar(5),
	@mdurum nvarchar(15),
	@maas nvarchar(50), -- bilinçli money yapmadım
	@eduzey nvarchar(50),
	@mbelge nvarchar(50),
	@meslek nvarchar(50)
AS
BEGIN

END
</code></pre>

<p>şeklinde bir hayali SP oluşturdum. Bu işlemde WHERE harici belki bize yabancı gelen bir method göreceğiz. COALESCE methodu. Bu metoda bakarsak eğer sınırsız sayıda parametre alabiliyor. Yaptığı işlemse ilk olarak NULL olmayan değeri geri döndürmektir. Eğer değer NULL ise zaten bu değeri geri döndürecektir.</p>

<p>Çalışma mantığına bakacak olursak öyle işlemektedir. Varsayalım ki WHERE kontrolü gerçekleştiriyoruz:</p>

<pre><code class="language-sql">WHERE kolonAdi=COALESCE(@spDegiskeni, kolonAdi)
</code></pre>

<p>şeklinde bir kontrol ile null ya da null olmayan tüm değerleri listeletebiliriz. Bu bilgilere bakarak o zaman ben diyebilirim ki gelen her değişkeni COALESCE ile işletip null olmayan bir değer döndürebilirim. Eğer NULL ise yine gelecek diyebilirim.</p>

<p>Örneğin yukarıda oluşturduğumuz SP içinden devam edelim:</p>

<pre><code class="language-sql">SELECT isim, soyisim, FROM InsanKanaklari as Ik
    WHERE (
        ik.dogumtarihi=COALESCE(@dtarih, ik.dogumtarihi)
        AND ik.dogumyeri=COALESCE(@dyeri, ik.dogumyeri)
        AND ik.cinsiyet=COALESCE(@cinsiyet, ik.cinsiyet)
        AND ik.medenidurum=COALESCE(@mdurum, ik.medenidurum)
        AND ik.maas=COALESCE(@maas, ik.maas)
        AND ik.egitimduzeyi=COALESCE(@eduzey, ik.egitimduzeyi)
        AND ik.meslekibelge=COALESCE(@mbelge, ik.meslekibelge)
        AND ik.meslek=COALESCE(@meslek, ik.meslek)
)
</code></pre>

<p>Burada öncelikle WHERE şartını gerçekleştirdik. Daha sonra ise WHERE şartında kolonun değerini, COALESCE işlemi ile karşılaştırıp değerleri getirebiliyoruz. COALESCE metodu ilk parametresinde sorgulanacak değeri, ikinci parametresinde de tablo kolonunu aldı. Bunu görerek filtreli sorgulama gerçekleştirebiliriz.</p>

<p>Son adımda SP şöyle oluyor:</p>

<pre><code class="language-sql">CREATE PROCEDURE PersonelAra
	@dtarih date,
	@dyeri nvarchar(50),
	@cinsiyet nvarchar(5),
	@mdurum nvarchar(15),
	@maas nvarchar(50), -- bilinçli money yapmadım
	@eduzey nvarchar(50),
	@mbelge nvarchar(50),
	@meslek nvarchar(50)
AS
BEGIN
    SELECT isim, soyisim, FROM InsanKanaklari as Ik
        WHERE (
            ik.dogumtarihi=COALESCE(@dtarih, ik.dogumtarihi)
            AND ik.dogumyeri=COALESCE(@dyeri, ik.dogumyeri)
            AND ik.cinsiyet=COALESCE(@cinsiyet, ik.cinsiyet)
            AND ik.medenidurum=COALESCE(@mdurum, ik.medenidurum)
            AND ik.maas=COALESCE(@maas, ik.maas)
            AND ik.egitimduzeyi=COALESCE(@eduzey, ik.egitimduzeyi)
            AND ik.meslekibelge=COALESCE(@mbelge, ik.meslekibelge)
            AND ik.meslek=COALESCE(@meslek, ik.meslek)
    )
END
</code></pre>


                <hr>
                
                  <div id="disqus_thread"></div>
                  <script type="text/javascript">
                    var disqus_shortname  = 'aligren';
                    var disqus_identifier = '/sql-serverda-filtreli-arama-gerceklestirme';
                    var disqus_title      = "SQL Server'da Filtreli Arama Gerceklestirme";

                    (function() {
                      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    })();
                  </script>
                  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                  <hr>
                
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="https:/aligoren.com/python-ve-ngram-algoritmasi" data-toggle="tooltip" data-placement="top" title="Python ve NGram Algoritması">&larr; Sonraki Yazı</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="https:/aligoren.com/sql-serverda-proceduree-getdate-yollamak" data-toggle="tooltip" data-placement="top" title="SQL Server'da Procedure'e GETDATE() Yollamak">Önceki Yazı &rarr;</a>
                    </li>
                    
                </ul>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="https://aligoren.com/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    <li>
                        <a href="https://github.com/aligoren">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="mailto:goren.ali@yandex.com">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">Copyright &copy;  2017</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="https://aligoren.com/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="https://aligoren.com/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="https://aligoren.com/js/clean-blog.min.js "></script>
<script src="https://aligoren.com/js/prism.js "></script>


    


</body>

</html>
