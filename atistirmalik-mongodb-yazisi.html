<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content=".NET, SQL, Python, Açık Kaynak">

    <title>Atıştırmalık MongoDB Yazısı - Ali GÖREN...</title>

    <link rel="canonical" href="https://aligoren.comhttps://aligoren.com/atistirmalik-mongodb-yazisi">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="https://aligoren.com/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="https://aligoren.com/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <!-- <link rel="stylesheet" href="https://aligoren.com/css/syntax.css"> -->
    <link rel="stylesheet" href="https://aligoren.com/css/prism.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <link type="application/atom+xml" rel="alternate" href="https://aligoren.com/feed.xml" title="Ali GÖREN..." />

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://aligoren.com/">Ali GÖREN...</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="https://aligoren.com/">Anasayfa</a>
                </li>
                
				
                
				
                <li>
                    <a href="https://aligoren.com/hakkimda">Hakkımda</a>
                </li>
				
                
				
                <li>
                    <a href="https://aligoren.com/kategoriler">Kategoriler</a>
                </li>
				
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header" style="background-image: url('https://aligoren.com/img/home-bg.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1 class="yazibasligi">Atıştırmalık MongoDB Yazısı</h1>
                    
                    <!--<span class="meta">Posted by Ali GÖREN... on December 17, 2016</span>-->
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 yaziici">

				<p>Selam bu yazı MongoDB’ye yeni giriş yapmış olan ben ve benim gibiler için atıştırmalık bir yazı.
Bu yazıda basit olarak insert ve select işlemlerinden bahsedeceğim. MongoDB nedir gibi artık klişe hale gelmiş bilgileri paylaşmak yerine direkt olarak nasıl yapılır’ı anlatacağım.</p>

<p><strong>[NOT]</strong>: Yazı uzun bir yazı olmuş. Şimdiden özür dilerim :)</p>

<p><img src="/images/posts/mongo.png" alt="/images/posts/mongo.png" /></p>

<h2 id="online-mongodb-ortamıyla-tanışın">Online MongoDB Ortamıyla Tanışın</h2>

<p>Pratiğe giriş yapmadan önce MongoDB bilgisayarınızda kurulu olmalı. MongoShell olmadan bilgisayarınızdan bağlantıyı kurmanız mümkün değil.
Online shell kullanırsanız ayrı. Kurulum aşamalarını geçtiniz varsayarak size MongoLaB sitesini önereceğim.</p>

<p><a href="https://mlab.com">https://mlab.com</a> Bu adrese girip kaydolarak ücretsiz 500 MB MongoDB hakkı kazanıyorsunuz.
Tabii ki online çalışmak zorunda değilsiniz bu bir alternatif.</p>

<p>Kaydolduktan sonra bir veritabanı oluşturmalısınız ve bu veritabanı için bir kullanıcı da oluşturmanız gerekiyor ki buraya kadar olan kısım standart yapıyla aynı.
Her şeyi doğru yaptıysanız çalışma alanınızın görüntüsü şöyle olmalı:</p>

<p><img src="/images/posts/mongolab.png" alt="/images/posts/mongolab.png" /></p>

<h2 id="mongodbyi-local-ortamda-kullanmak">MongoDB’yi Local Ortamda Kullanmak</h2>

<p>Eğer MongoDB’yi herhangi bir sınırlama olmaksızın (500 MB gibi) local ortamda kullanmak isterseniz öncelikle komut satırına <code>mongod</code> komutunu yazmalısınız.
Bu sayede MongoDB sunucusu başlatılır. Varsayılan port olarak <strong>27017</strong> dinlenir. Bunu söyleme sebebim yukarıdaki ilk seçenekte varsayılan port farklı.</p>

<p><img src="/images/posts/mongod_local.png" alt="/images/posts/mongod_local.png" /></p>

<p>Daha sonra ikinci bir komut satırını açarak mongo komutunu verip local mongodb kullanımına başlayabilirsiniz.</p>

<p><img src="/images/posts/mongo_local.png" alt="/images/posts/mongo_local.png" /></p>

<h3 id="veritabanını-seçelim">Veritabanını Seçelim</h3>

<p>Veritabanını seçme işlemi, mongoshell üzerinde diğerlerinde olduğu gibi <code>use</code> ile olacaktır. Localde çalışanlar için test veritanı şöyle seçilir:</p>

<pre><code class="language-sql">use test
</code></pre>

<h3 id="ufaktan-insert-operasyonları">Ufaktan Insert Operasyonları</h3>

<p>Veritabanını seçtik. MongoDB kullanırken insert operasyonları, RDBMS’lerden farklı şekilde çalışabilir. Burada yaşayacağınız farklılık syntax anlamında olabilir.
Ancak NodeJS kullanıcılarının bu işlemlere karşı yabancı olacağı pek söylenemez :)</p>

<p>MongoDB’de insert operasyonları üç metod altında toplanmıştır. Bunlar sırasıyla;</p>

<p><strong>insert()</strong>, <strong>insertOne()</strong> ve <strong>insertMany()</strong> metodlarıdır.
Bu metodları kullanırken verilerin JSON türünden olduğuna dikkat etmelisiniz. Yani JSON’a da aşina olmanız gerekmektedir. Neyse ki öğrenmesi çok da zor değil.</p>

<p><strong>Basit Olarak Insert</strong></p>

<p>Basit olarak bir insert operasyonu şöyle olur.</p>

<p>DBNESNESİ.TABLO.INSERT bu sahte yöntemin gerçeğe dönüşmüş hali şöyledir:</p>

<pre><code class="language-js">db.Tablo.insert({
    'alan': 'Verisi',
    'alan2': 'Baska Veri'
})
</code></pre>

<p>O zaman bir blog sisteminin yapısından yola çıkarak şöyle olacak diyebiliriz:</p>

<pre><code class="language-js">db.Yazilar.insert({
    'Baslik': 'Blog Başlığı',
    'Icerik': 'Lorem Ipsum Dolor Sit Amet...',
    'Kategori': 'Kişisel'
})
</code></pre>

<p>Evet klasik bir insert operasyonunu gördük. Bu kodları Mongoshell üzerinde çalıştırınca şu çıktıyı alırsanız her şey doğrudur:</p>

<pre><code class="language-json">WriteResult({ "nInserted" : 1 })
</code></pre>

<p><strong>Nedir Bu insertOne() ?</strong></p>

<p>Bilinen bir yanlıştan dolayı insert ve insertOne karıştırılmakta. insert sadece tek bir ekleme yapmaz.
Eğer sadece insert metodunu kullanıyorsanız birden fazla ekleme de yapabilirsiniz. Örnek:</p>

<pre><code class="language-js">db.Yazilar.insert([
    {"Baslik": "Başka"},
    {"Baslik": "Oteki"}
])

/*
ÇIKTISI:

BulkWriteResult({
        "writeErrors" : [ ],
        "writeConcernErrors" : [ ],
        "nInserted" : 2,
        "nUpserted" : 0,
        "nMatched" : 0,
        "nModified" : 0,
        "nRemoved" : 0,
        "upserted" : [ ]
})

*/
</code></pre>

<p>Ancak insertOne metodu böyle değil. Sadece ve sadece bir adet ekleme gerçekleştirebilirsiniz.
Ayrıca insertOne metodu ile insert edilen içeriğin ID’sini de alabilirsiniz. Kullanımı şöyledir:</p>

<pre><code class="language-js">db.Yazilart.insertOne({
    "Baslik": "Tek Başlık"
})
</code></pre>

<p>Yani ikinci bir başlık ekleme işlemi yapamazsınız. Evet bu kadar basit.</p>

<p><strong>Gelelim insertMany() Metoduna</strong></p>

<p>insert ve insertMany metodları da çoklu ekleme işlemlerini destekler.
Ancak insert metodu ile yapılan ekleme işlemlerinde, geriye bir <code>insertedId</code> dönmezdi. Aynı işlemi <code>insertMany</code> ile yaparsak bir ID dönüşü alırız:</p>

<pre><code class="language-js">db.Yazilar.insertMany([
    {"Baslik": "Başka"},
    {"Baslik": "Oteki"}
])

/*
ÇIKTISI:

{
        "acknowledged" : true,
        "insertedIds" : [
                ObjectId("5855b0a5f7e668b0e155210f"),
                ObjectId("5855b0a5f7e668b0e1552110")
        ]
}
*/
</code></pre>

<h3 id="Şimdi-bu-verileri-nasıl-Çekeriz">Şimdi Bu Verileri Nasıl Çekeriz?</h3>

<p>Veri çekme işlemi MongoDB üzerindeki en basit işlemlerdendir. Örneğin Yazilar tablosundan verileri çekelim. Bunun için <code>find()</code> metodunu kullanırız:</p>

<pre><code class="language-js">db.Yazilar.find()

/*
ÇIKTISI:

{ "_id" : ObjectId("5855aef5f7e668b0e155210c"), "BAŞLIK" : "İçerik" }
{ "_id" : ObjectId("5855aef5f7e668b0e155210d"), "BAŞLIK BAŞKA" : "İçerik 2" }
{ "_id" : ObjectId("5855afd0f7e668b0e155210e"), "ÖTEKİ" : "İçerik 3" }
{ "_id" : ObjectId("5855b0a5f7e668b0e155210f"), "FALAN" : "İçerik 4" }
{ "_id" : ObjectId("5855b0a5f7e668b0e1552110"), "NEYSE" : "İçerik 5" }
*/

</code></pre>

<h3 id="nerede-bu-where-clause">Nerede Bu WHERE Clause?</h3>

<p>Benim en çok merak ettiklerimden birisi de bu konuydu. MongoDB üzerinde where aynı mantığa sahip olsa da kullanımı tabii ki farklı. Yine find() metodunu kullanacağız.</p>

<pre><code class="language-js">db.Yazilar.find({ $where: "this.Baslik == 'FALAN'" })
</code></pre>

<p>Yukarıdaki kullanımla tek satırlık bir değer dönecektir. Ancak aynı değere sahip 2 içerik varsa onları unique yapan diğer değerleri de sorgulamanız iyi olur.</p>

<h3 id="hadi-bu-İçerikleri-sıralayalım">Hadi Bu İçerikleri Sıralayalım</h3>

<p>ASC ve DESC olaylarını RDBMS üzerinde kullanırken ORDER BY kullanıyorduk. Ancak bunda maalesef ki böyle değil. Fakat daha basit olduğunu söyleyebilirim.
Yine find() metodunu olaya dahil ederek şöyle bir işlem yapabiliriz:</p>

<pre><code class="language-js">db.Yazilar.find().sort({_id:1})
</code></pre>

<p>Yukarıdaki yöntemle birlikte ASCENDING bir sıralama yapabilirsiniz. Bunun tam tersi olarak DESCENDING işlemi ise şöyle yapılır:</p>

<pre><code class="language-js">db.Yazilar.find().sort({_id:-1})
</code></pre>

<h3 id="limit-falan-nasıl-olacak">Limit Falan Nasıl Olacak?</h3>

<p>Şimdi bu işlemde de find() metodunu kullanıyoruz. Tabi bu sefer sort() metodu da bize katılıyor.
Limit işlemini limit() metodunu kullanarak yaparız. Örneğin kullanımı şöyle:</p>

<pre><code class="language-js">db.Yazilar.find().sort({ID:-1}).limit(1)
</code></pre>

<p>Yukarıdaki yöntem bize son eklenen verinin içeriğini döndürecektir ve dönen değer tek satırdır.
Çünkü limit metodu parametre olarak tek <strong>1</strong> rakamını almıştır. Dilersek dönen değerdeki tek bir alana dair de veri çekebiliriz.
Ben bu işlemde kendim <strong>ID</strong> adında bir alan tanımladım. MongoDB tarafından üretilen <strong>_id</strong> alanından farklı olduğunu belirteyim. Şimdi tanımlı olan bu alanı çekelim:</p>

<pre><code class="language-js">db.Yazilar.find().sort({ID:-1}).limit(1)[0]["ID"]
</code></pre>

<p>Buradan anlaşılacağı üzere eklenmiş olan verilerden en sonuncusu getirilip bu satırdaki ID alanında yer alan veriyi göreceğiz.
Klasik bir array access işleminden fazlası değil yani.</p>

<p>Evet anlatım bu kadar. Uzun bir yazı dizisi oldu. Eğer CRUD işlemleri hakkında daha fazla bilgi istiyorsanız 
<a href="https://docs.mongodb.com/manual/crud/">MongoDB Manual</a> sizin için iyi bir yol gösterici olacaktır.</p>


                <hr>
                
                  <div id="disqus_thread"></div>
                  <script type="text/javascript">
                    var disqus_shortname  = 'aligren';
                    var disqus_identifier = '/atistirmalik-mongodb-yazisi';
                    var disqus_title      = "Atıştırmalık MongoDB Yazısı";

                    (function() {
                      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    })();
                  </script>
                  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                  <hr>
                
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="https:/aligoren.com/mongodb-data-directory-not-found" data-toggle="tooltip" data-placement="top" title="MongoDB Data Directory Not Found Hatası">&larr; Sonraki Yazı</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="https:/aligoren.com/atistirmalik-mongodb-yazisi-2" data-toggle="tooltip" data-placement="top" title="Atıştırmalık MongoDB Yazısı - 2">Önceki Yazı &rarr;</a>
                    </li>
                    
                </ul>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="https://aligoren.com/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    <li>
                        <a href="https://github.com/aligoren">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="mailto:goren.ali@yandex.com">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">Copyright &copy;  2017</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="https://aligoren.com/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="https://aligoren.com/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="https://aligoren.com/js/clean-blog.min.js "></script>
<script src="https://aligoren.com/js/prism.js "></script>


    


</body>

</html>
